# ðŸ”’ 21. AWS - access web application through HTTPS

We have finished tasks to access our application from public internet by HTTP. Most of the websites support HTTPS since HTTP is not a secure protocol. The ideal way is to host our application by using our own DNS name and with HTTPS enabled. Amazon can support this but it needs some additonal materials:

>A DNS record we applied from any DNS service provider
>
>A CNAME record added in that service provider with value provided by AWS

I have applied a free DNS record from a provider but it has limited features and can't let me add a CNAME record for free. An alternative is to access the application still by the Application Load Balancer DNS name, with HTTPS support. Below will show the steps.

First we need to have a host with a public IPv4 address. I used a EC2 Ubuntu instance in AWS. SSH login to it, we'll get a certifacte through Letsencrypt.

Below suppose the DNS name we have is **myapp.ddns.net**.

Start a HTTP server in a folder we created:

>mkdir -p ~/letsencrypt/.well-known/acme-challenge
>
>cd ~/letsencrypt
>
>echo "test" > .well-known/acme-challenge/test-file
>
> python3 -m http.server 80

Go to the DNS service provider, modify the DNS record to add the public IP address of the host which is running the HTTP server.

From another host, make sure the DNS record is updated:

>nslookup myapp.ddns.net

If it returns the IP address of the host which is running the HTTP server, then DNS record is updated correctly. We can try to access the file we created:

>curl http://myapp.ddns.net/.well-known/acme-challenge/test-file

If curl can get the file content, we are now ready with a HTTP server which can be accessed by its DNS name.

Now try to get certificate from Letsencrypt. From the host which is running HTTP server, do the following:

>apt install -y certbot
>
>certbot certonly --manual --preferred-challenges http -d  myapp.ddns.net

Following the prompts. It will require us to put a file under folder **~/letsencrypt/.well-known/acme-challenge**, with the file name and file content specified in the prompts.

Wait for verification process complete, two files will be generated in folder /etc/letsencrypt/live/myapp.ddns.net: fullchain.pem and privkey.pem.

Now navigate to **AWS Certificate Manager --> Import certificate**. Fill in the following:

>Certificate body: the first "BEGIN... END" part of fullchain.pem
>
>Certificate private key: the content of privkey.pem
>
>Certificate chain: the second "BEGIN...END" part of fullchain.pem

Click **Import certificate**.

Navigate to **EC2 --> Load balancers -->my-learning-app-alb --> Listeners and rules --> Add listener**. Fill in the following:

>Protocol: HTTPS
>
>Routing action: Forward to target groups
>
>Target group: select **frontend-tg**
>
>Security policy: use the default setting
>
>Default SSL/TLS sever certificate: From ACM, choose the certificate we imported

Click **Add listener**.

Now verify if we can access our application by using Application Load Balancer DNS name with HTTPS protocol from web browser.
