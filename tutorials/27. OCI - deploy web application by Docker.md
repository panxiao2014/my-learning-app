# ðŸ³ 27. OCI - deploy web application by Docker

In AWS we deployed our web application by using ECS serverless cluster. I didn't find Oracle provides the similar service so I'll deploy the application in the running instance by Docker.

I'll create a new docker compose file docker-compose-oci.yml. In the original docker-compose.yml we start a PostgreSql container, but in OCI we have the MySQL server running so it is not needed such container any more. Below is the content of the file:

```
version: "3.9"

services:
  backend:
    restart: "no"
    image: my-backend:latest
    container_name: backend.mylearningapp.local
    environment:
      OCI_DATABASE_HOST: ${OCI_DATABASE_HOST}
      OCI_DATABASE_USERNAME: ${OCI_DATABASE_USERNAME}
      OCI_DATABASE_PASSWORD: ${OCI_DATABASE_PASSWORD}
    ports:
    ports:
      - "3306:3306"
    networks:
      - myapp-network

  frontend:
    restart: "no"
    image: my-frontend:latest
    container_name: frontend
    depends_on:
      backend:
        condition: service_started
    ports:
      - "80:80"
    networks:
      - myapp-network

networks:
  myapp-network:
    driver: bridge
```

We have read the three variables from host environment as we mentioned in previous tutorial. With our code already updated to support these variables, we can build the image now and we only need to build the backend image:

>docker build -f Dockerfile-backend -t my-backend:latest .

Before start the container, set the three variables:

>export OCI_DATABASE_HOST=\<your MySQL server address>
>
>export OCI_DATABASE_USERNAME=\<your server username>
>
>export OCI_DATABASE_PASSWORD=\<your server password>

Then start containers:

>docker-compose -f docker-compose-oci.yml up

We can access the running instance port 80 through its public IP address to check if the appliation is running well.

To further check if application can manage the database server without problem, we can add some users from the web page. And then connect to the server from the instance:

>mysql -h \<server IP address> -u \<server user name> -p

Then check the table content:

>use userdb;
>
>select * from users;

We should see the user added from web be displayed here. Also, with our load balancer is running, we can start web application in both of our running instances, and then access it from load balancer's IP address or the domain name we associated with the IP address.

Now we have a complete and typical web application running: user access it by a domain name through secure HTTPS method. The cloud service provider use a load balancer to route client traffic to two running instances, and both of them could manage a database running in the cloud.

